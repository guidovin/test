package br.com.fes.relatorios.dao;

import java.sql.SQLException;

import br.com.fes.relatorios.domain.Dados;

public class DadosDAO {
	
	public String consultar(Dados dados) throws SQLException, Exception{
		
		StringBuilder query = new StringBuilder();
		
		query.append("SELECT * FROM alunos");

		System.out.println("caminho 1");
		 if(!(dados.getMatrícula().toString().isEmpty()) || !(dados.getNome().isEmpty()) || !(dados.getIdade().isEmpty())  || !(dados.getEscola().isEmpty()) || !(dados.getSerie().isEmpty())){
			System.out.println("caminho 2");
			query.append(" WHERE ");
		}
		else if(dados.getMatrícula().toString().isEmpty() && dados.getNome().isEmpty() && dados.getIdade().isEmpty()  && dados.getEscola().isEmpty() && dados.getSerie().isEmpty()){
			System.out.println("caminho 3");
			return query.toString();
			
		}

		if(!(dados.getMatrícula().toString().isEmpty())){
			query.append("matricula LIKE '" + dados.getMatrícula().toString() + "'");
			System.out.println("Query : " + query.toString());
		}
		
		if(!(dados.getMatrícula().toString().isEmpty()) && !(dados.getNome().isEmpty())){
			query.append(" AND nome LIKE '" + dados.getNome() + "'"); 
			System.out.println("Query : " + query.toString());
		} else if(dados.getMatrícula().toString().isEmpty() && !(dados.getNome().isEmpty())){
			query.append("nome LIKE '" + dados.getNome() + "'"); 
		}
		
		if((!(dados.getMatrícula().toString().isEmpty()) || !(dados.getNome().isEmpty())) && !(dados.getIdade().toString().isEmpty())){
			query.append(" AND idade = " + dados.getIdade());	
			System.out.println("Query : " + query.toString());
		} else if((dados.getMatrícula().toString().isEmpty() && (dados.getNome().isEmpty()) && !(dados.getIdade().isEmpty()))){ 
			query.append("idade = " + dados.getIdade());
		}
		
		if((!(dados.getMatrícula().toString().isEmpty()) || !(dados.getNome().isEmpty()) || !(dados.getIdade().isEmpty()))  && !(dados.getEscola().isEmpty()) ){
			query.append(" AND escola LIKE '" + dados.getEscola() + "'");	
			System.out.println("Query : " + query.toString());
		} else if(dados.getMatrícula().toString().isEmpty() && dados.getNome().isEmpty() && dados.getIdade().isEmpty()  && !(dados.getEscola().isEmpty())){
			query.append("escola LIKE '" + dados.getEscola() + "'");	
		}

		if((!(dados.getMatrícula().toString().isEmpty()) || !(dados.getNome().isEmpty()) || !(dados.getIdade().isEmpty())  || !(dados.getEscola().isEmpty())) && !(dados.getSerie().isEmpty())){
			query.append(" AND serie LIKE '" + dados.getSerie() + "'");	
			System.out.println("Query : " + query.toString());
		} else if(dados.getMatrícula().toString().isEmpty() && dados.getNome().isEmpty() && dados.getIdade().isEmpty() && dados.getEscola().isEmpty() && !(dados.getSerie().isEmpty())){
			query.append("serie LIKE '" + dados.getSerie() + "'");	
		}

		System.out.println("Query : " + query.toString());
		return query.toString();
		
	}
	
}
