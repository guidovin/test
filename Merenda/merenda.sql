-- MySQL Script generated by MySQL Workbench
-- s√°b 12 mai 2018 20:11:36 -03
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema merenda
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `merenda` ;

-- -----------------------------------------------------
-- Schema merenda
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `merenda` DEFAULT CHARACTER SET utf8 COLLATE utf8_unicode_ci ;
USE `merenda` ;

-- -----------------------------------------------------
-- Table `merenda`.`funcao`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`funcao` ;

CREATE TABLE IF NOT EXISTS `merenda`.`funcao` (
  `id_funcao` INT NOT NULL AUTO_INCREMENT,
  `funcao` VARCHAR(45) NULL,
  PRIMARY KEY (`id_funcao`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`tipo`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`tipo` ;

CREATE TABLE IF NOT EXISTS `merenda`.`tipo` (
  `id_tipo` INT NOT NULL AUTO_INCREMENT,
  `tipo` VARCHAR(45) NULL,
  PRIMARY KEY (`id_tipo`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`instituicao`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`instituicao` ;

CREATE TABLE IF NOT EXISTS `merenda`.`instituicao` (
  `id_instituicao` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(80) NULL,
  `inep` VARCHAR(8) NULL,
  `endereco` VARCHAR(120) NULL,
  `diretor` VARCHAR(80) NULL,
  `qtd_alunos` INT(11) NULL,
  `id_tipo` INT NOT NULL,
  PRIMARY KEY (`id_instituicao`),
  INDEX `fk_Instituicao_Tipo1_idx` (`id_tipo` ASC),
  CONSTRAINT `fk_Instituicao_Tipo1`
    FOREIGN KEY (`id_tipo`)
    REFERENCES `merenda`.`tipo` (`id_tipo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`usuario`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`usuario` ;

CREATE TABLE IF NOT EXISTS `merenda`.`usuario` (
  `id_usuario` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(80) NULL,
  `cpf` VARCHAR(11) NULL,
  `matricula` VARCHAR(20) NULL,
  `data_nascimento` DATE NULL,
  `telefone` VARCHAR(14) NULL,
  `endereco` VARCHAR(45) NULL,
  `senha` VARCHAR(45) NULL,
  `id_funcao` INT NOT NULL,
  `id_instituicao` INT NOT NULL,
  PRIMARY KEY (`id_usuario`),
  INDEX `fk_Usuario_Funcao_idx` (`id_funcao` ASC),
  INDEX `fk_Usuario_Instituicao1_idx` (`id_instituicao` ASC),
  CONSTRAINT `fk_Usuario_Funcao`
    FOREIGN KEY (`id_funcao`)
    REFERENCES `merenda`.`funcao` (`id_funcao`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Usuario_Instituicao1`
    FOREIGN KEY (`id_instituicao`)
    REFERENCES `merenda`.`instituicao` (`id_instituicao`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`item`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`item` ;

CREATE TABLE IF NOT EXISTS `merenda`.`item` (
  `id_item` INT NOT NULL AUTO_INCREMENT,
  `nome` VARCHAR(80) NULL,
  `tipo` VARCHAR(1) NULL,
  `qtd_atende` INT(11) NULL,
  PRIMARY KEY (`id_item`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`lote`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`lote` ;

CREATE TABLE IF NOT EXISTS `merenda`.`lote` (
  `id_lote` INT NOT NULL AUTO_INCREMENT,
  `preco` FLOAT NULL,
  `qtd_itens` INT(11) NULL,
  `validade` DATE NULL,
  `id_item` INT NOT NULL,
  PRIMARY KEY (`id_lote`),
  INDEX `fk_Lote_Item1_idx` (`id_item` ASC),
  CONSTRAINT `fk_Lote_Item1`
    FOREIGN KEY (`id_item`)
    REFERENCES `merenda`.`item` (`id_item`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`entrega`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`entrega` ;

CREATE TABLE IF NOT EXISTS `merenda`.`entrega` (
  `id_entrega` INT NOT NULL AUTO_INCREMENT,
  `data_entrega` DATE NULL,
  `fornecedor` VARCHAR(45) NULL,
  `id_escola` INT NOT NULL,
  PRIMARY KEY (`id_entrega`),
  INDEX `fk_Entrega_Escola1_idx` (`id_escola` ASC),
  CONSTRAINT `fk_Entrega_Escola1`
    FOREIGN KEY (`id_escola`)
    REFERENCES `merenda`.`instituicao` (`id_instituicao`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `merenda`.`encomenda`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `merenda`.`encomenda` ;

CREATE TABLE IF NOT EXISTS `merenda`.`encomenda` (
  `id_entrega` INT NOT NULL AUTO_INCREMENT,
  `id_lote` INT NOT NULL,
  PRIMARY KEY (`id_entrega`, `id_lote`),
  INDEX `fk_Entrega_has_Lote_Lote1_idx` (`id_lote` ASC),
  INDEX `fk_Entrega_has_Lote_Entrega1_idx` (`id_entrega` ASC),
  CONSTRAINT `fk_Entrega_has_Lote_Entrega1`
    FOREIGN KEY (`id_entrega`)
    REFERENCES `merenda`.`entrega` (`id_entrega`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Entrega_has_Lote_Lote1`
    FOREIGN KEY (`id_lote`)
    REFERENCES `merenda`.`lote` (`id_lote`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
